(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8890:function(e,a,s){Promise.resolve().then(s.bind(s,6245))},6245:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return O}});var t=s(7437),r=s(2265),l=s(9376),i=s(429),n=s(9763);let o=(0,n.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var c=s(2369);let d=(0,n.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),m=(0,n.Z)("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),x=(0,n.Z)("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),h=(0,n.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),p=(0,n.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),u=(0,n.Z)("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);var y=s(8997),g=s(2718);let b=(0,n.Z)("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]),f=(0,n.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);function j(e){let{userId:a}=e,[s,l]=(0,r.useState)([]),[n,o]=(0,r.useState)(!0),[d,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(!1),[j,v]=(0,r.useState)({}),[N,w]=(0,r.useState)({}),[k,S]=(0,r.useState)({}),[C,P]=(0,r.useState)({});(0,r.useEffect)(()=>{Z()},[a]);let Z=async()=>{try{let e=localStorage.getItem("token"),a=await fetch("/api/posts/feed",{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();l(e.data.posts)}}catch(e){console.error("Failed to fetch posts:",e)}finally{o(!1)}},E=async e=>{try{let a=localStorage.getItem("token"),s=await fetch("/api/comments/post/".concat(e),{headers:{Authorization:"Bearer ".concat(a)}});if(s.ok){let a=await s.json();v(s=>({...s,[e]:a.data.comments}))}}catch(e){console.error("Failed to fetch comments:",e)}},M=async e=>{if(e.preventDefault(),d.trim()){h(!0);try{let e=localStorage.getItem("token");(await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({content:d})})).ok&&(m(""),Z())}catch(e){console.error("Failed to create post:",e)}finally{h(!1)}}},A=async(e,a)=>{try{let s=localStorage.getItem("token");(await fetch("/api/posts/".concat(e,"/reactions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({type:a})})).ok&&Z()}catch(e){console.error("Failed to add reaction:",e)}},z=async e=>{var a;let s=null===(a=N[e])||void 0===a?void 0:a.trim();if(s){P(a=>({...a,[e]:!0}));try{let a=localStorage.getItem("token");(await fetch("/api/comments",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({content:s,postId:e})})).ok&&(w(a=>({...a,[e]:""})),E(e),Z())}catch(e){console.error("Failed to add comment:",e)}finally{P(a=>({...a,[e]:!1}))}}},I=e=>{S(a=>{let s={...a,[e]:!a[e]};return s[e]&&!j[e]&&E(e),s})},U=e=>e.reactions.some(e=>e.authorId===a&&"LIKE"===e.type),F=e=>{let a=new Date(e),s=Math.floor((new Date().getTime()-a.getTime())/36e5);return s<1?"Just now":s<24?"".concat(s,"h ago"):s<168?"".concat(Math.floor(s/24),"d ago"):a.toLocaleDateString()};return n?(0,t.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,a)=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 animate-pulse",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-2"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]})]},a))}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,t.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-primary-400 to-accent-500 rounded-full flex items-center justify-center text-white font-semibold",children:(0,t.jsx)(c.Z,{className:"h-5 w-5"})}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("textarea",{value:d,onChange:e=>m(e.target.value),placeholder:"What's on your mind?",className:"w-full p-3 border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,disabled:x})})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{type:"submit",disabled:!d.trim()||x,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Posting...":"Post"})})]})}),(0,t.jsx)("div",{className:"space-y-6",children:s.map((e,a)=>{var s,r;return(0,t.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*a},className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,t.jsx)("div",{className:"p-6 pb-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-primary-400 to-accent-500 rounded-full flex items-center justify-center text-white font-semibold",children:e.author.avatar?(0,t.jsx)("img",{src:e.author.avatar,alt:e.author.name,className:"w-10 h-10 rounded-full object-cover"}):e.author.name.charAt(0).toUpperCase()}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:e.author.name}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,t.jsx)(p,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:F(e.createdAt)})]})]})]}),(0,t.jsx)("button",{className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:(0,t.jsx)(u,{className:"h-4 w-4 text-gray-500"})})]})}),(0,t.jsxs)("div",{className:"px-6 pb-4",children:[(0,t.jsx)("p",{className:"text-gray-900 leading-relaxed",children:e.content}),e.images&&e.images.length>0&&(0,t.jsx)("div",{className:"mt-4 grid grid-cols-1 gap-2",children:e.images.map((e,a)=>(0,t.jsx)("img",{src:e,alt:"Post image ".concat(a+1),className:"w-full h-64 object-cover rounded-lg"},a))})]}),(0,t.jsx)("div",{className:"px-6 py-4 border-t border-gray-100",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsxs)("button",{onClick:()=>A(e.id,"LIKE"),className:"flex items-center space-x-2 transition-colors duration-200 ".concat(U(e)?"text-red-500 hover:text-red-600":"text-gray-500 hover:text-red-500"),children:[(0,t.jsx)(y.Z,{className:"h-5 w-5 ".concat(U(e)?"fill-current":"")}),(0,t.jsx)("span",{children:e._count.reactions})]}),(0,t.jsxs)("button",{onClick:()=>I(e.id),className:"flex items-center space-x-2 text-gray-500 hover:text-blue-500 transition-colors duration-200",children:[(0,t.jsx)(g.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:e._count.comments})]}),(0,t.jsxs)("button",{className:"flex items-center space-x-2 text-gray-500 hover:text-green-500 transition-colors duration-200",children:[(0,t.jsx)(b,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Share"})]})]})})}),k[e.id]&&(0,t.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100",children:[(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-400 to-accent-500 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:(0,t.jsx)(c.Z,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex-1 flex space-x-2",children:[(0,t.jsx)("input",{type:"text",value:N[e.id]||"",onChange:a=>w(s=>({...s,[e.id]:a.target.value})),placeholder:"Write a comment...",className:"flex-1 p-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent",onKeyPress:a=>"Enter"===a.key&&z(e.id)}),(0,t.jsx)("button",{onClick:()=>z(e.id),disabled:!(null===(s=N[e.id])||void 0===s?void 0:s.trim())||C[e.id],className:"p-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:(0,t.jsx)(f,{className:"h-4 w-4"})})]})]})}),(0,t.jsxs)("div",{className:"space-y-3",children:[null===(r=j[e.id])||void 0===r?void 0:r.map(e=>(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-400 to-accent-500 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:e.author.avatar?(0,t.jsx)("img",{src:e.author.avatar,alt:e.author.name,className:"w-8 h-8 rounded-full object-cover"}):e.author.name.charAt(0).toUpperCase()}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,t.jsx)("span",{className:"font-semibold text-sm text-gray-900",children:e.author.name}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:F(e.createdAt)})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.content})]})})]},e.id)),(!j[e.id]||0===j[e.id].length)&&(0,t.jsx)("p",{className:"text-sm text-gray-500 text-center py-2",children:"No comments yet. Be the first to comment!"})]})]}),!k[e.id]&&e.comments&&e.comments.length>0&&(0,t.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100",children:(0,t.jsxs)("div",{className:"space-y-3",children:[e.comments.slice(0,2).map(e=>(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-primary-400 to-accent-500 rounded-full flex items-center justify-center text-white text-xs font-semibold",children:e.author.avatar?(0,t.jsx)("img",{src:e.author.avatar,alt:e.author.name,className:"w-6 h-6 rounded-full object-cover"}):e.author.name.charAt(0).toUpperCase()}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,t.jsx)("span",{className:"font-semibold text-sm text-gray-900",children:e.author.name}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:F(e.createdAt)})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.content})]})})]},e.id)),e.comments.length>2&&(0,t.jsxs)("button",{onClick:()=>I(e.id),className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:["View all ",e.comments.length," comments"]})]})})]},e.id)})}),0===s.length&&!n&&(0,t.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(g.Z,{className:"h-8 w-8 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No posts yet"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Start sharing with your family and friends!"})]})]})}var v=s(2208);let N=(0,n.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),w=(0,n.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),k=(0,n.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);var S=s(3581);function C(e){var a,s,l,n,o,c,d,m,x,h,p,u;let{userId:y}=e,[g,b]=(0,r.useState)([]),[f,j]=(0,r.useState)(!0),[C,P]=(0,r.useState)(null),[Z,E]=(0,r.useState)("grid");(0,r.useEffect)(()=>{M()},[y]);let M=async()=>{try{let s=localStorage.getItem("token"),t=await fetch("/api/galleries/".concat(y),{headers:{Authorization:"Bearer ".concat(s)}});if(t.ok){var e,a;let s=await t.json();console.log(s.data),b(null!==(a=null===(e=s.data)||void 0===e?void 0:e.images)&&void 0!==a?a:[])}}catch(e){console.error("Failed to fetch gallery:",e)}finally{j(!1)}},A=async e=>{if(confirm("Are you sure you want to delete this image?"))try{let a=localStorage.getItem("token");(await fetch("/api/images/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}})).ok&&b(g.filter(a=>a.id!==e))}catch(e){console.error("Failed to delete image:",e)}},z=e=>{if(0===e)return"0 Bytes";let a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]},I=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return f?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 animate-pulse"}),(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-24 animate-pulse"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[...Array(8)].map((e,a)=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 animate-pulse",children:[(0,t.jsx)("div",{className:"w-full h-48 bg-gray-200 rounded-lg mb-3"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]},a))})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-serif font-bold text-gray-900",children:"Your Gallery"}),(0,t.jsxs)("p",{className:"text-gray-600 mt-1",children:[null!==(c=null==g?void 0:g.length)&&void 0!==c?c:0," ",(null==g?void 0:g.length)===1?"image":"images"," in your collection"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("button",{onClick:()=>E("grid"),className:"p-2 rounded-lg transition-colors duration-200 ".concat("grid"===Z?"bg-primary-100 text-primary-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-1 w-4 h-4",children:[(0,t.jsx)("div",{className:"bg-current rounded-sm"}),(0,t.jsx)("div",{className:"bg-current rounded-sm"}),(0,t.jsx)("div",{className:"bg-current rounded-sm"}),(0,t.jsx)("div",{className:"bg-current rounded-sm"})]})}),(0,t.jsx)("button",{onClick:()=>E("list"),className:"p-2 rounded-lg transition-colors duration-200 ".concat("list"===Z?"bg-primary-100 text-primary-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:(0,t.jsxs)("div",{className:"space-y-1 w-4 h-4",children:[(0,t.jsx)("div",{className:"bg-current rounded-sm h-1"}),(0,t.jsx)("div",{className:"bg-current rounded-sm h-1"}),(0,t.jsx)("div",{className:"bg-current rounded-sm h-1"})]})})]})]}),"grid"===Z?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:(null!=g?g:[]).map((e,a)=>{var s,r,l,n,o,c,d,m,x,h,p;return(0,t.jsxs)(i.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1*a},className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden group hover:shadow-md transition-shadow duration-200",children:[(0,t.jsxs)("div",{className:"relative aspect-square overflow-hidden",children:[(0,t.jsx)("img",{src:e.url,alt:e.title||"Gallery image",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[(0,t.jsx)("button",{onClick:()=>P(e),className:"p-2 bg-white rounded-full shadow-lg hover:bg-gray-50 transition-colors duration-200",children:(0,t.jsx)(v.Z,{className:"h-4 w-4 text-gray-700"})}),(0,t.jsx)("a",{href:e.url,download:!0,className:"p-2 bg-white rounded-full shadow-lg hover:bg-gray-50 transition-colors duration-200",children:(0,t.jsx)(N,{className:"h-4 w-4 text-gray-700"})}),(0,t.jsx)("button",{onClick:()=>A(e.id),className:"p-2 bg-white rounded-full shadow-lg hover:bg-red-50 transition-colors duration-200",children:(0,t.jsx)(w,{className:"h-4 w-4 text-red-600"})})]})})]}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-1 truncate",children:e.title||"Untitled"}),e.description&&(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,t.jsx)("span",{children:z(null!==(c=null===(s=e.metadata)||void 0===s?void 0:s.size)&&void 0!==c?c:0)}),(0,t.jsx)("span",{children:(null!==(d=null===(r=e.metadata)||void 0===r?void 0:r.format)&&void 0!==d?d:"").toUpperCase()})]}),(null!==(m=null===(l=e.tags)||void 0===l?void 0:l.length)&&void 0!==m?m:0)>0&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[(null!==(x=e.tags)&&void 0!==x?x:[]).slice(0,3).map(e=>(0,t.jsx)("span",{className:"px-2 py-1 bg-primary-100 text-primary-700 text-xs rounded-full",children:e},e)),(null!==(h=null===(n=e.tags)||void 0===n?void 0:n.length)&&void 0!==h?h:0)>3&&(0,t.jsxs)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",(null!==(p=null===(o=e.tags)||void 0===o?void 0:o.length)&&void 0!==p?p:0)-3]})]})]})]},e.id)})}):(0,t.jsx)("div",{className:"space-y-4",children:(null!=g?g:[]).map((e,a)=>{var s,r,l,n,o,c,d;return(0,t.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*a},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"relative w-20 h-20 flex-shrink-0",children:(0,t.jsx)("img",{src:e.url,alt:e.title||"Gallery image",className:"w-full h-full object-cover rounded-lg"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:e.title||"Untitled"}),e.description&&(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,t.jsx)(k,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:I(e.createdAt)})]}),(0,t.jsx)("span",{children:z(null!==(n=null===(s=e.metadata)||void 0===s?void 0:s.size)&&void 0!==n?n:0)}),(0,t.jsx)("span",{children:(null!==(o=null===(r=e.metadata)||void 0===r?void 0:r.format)&&void 0!==o?o:"").toUpperCase()})]}),(null!==(c=null===(l=e.tags)||void 0===l?void 0:l.length)&&void 0!==c?c:0)>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:(null!==(d=e.tags)&&void 0!==d?d:[]).map(e=>(0,t.jsx)("span",{className:"px-2 py-1 bg-primary-100 text-primary-700 text-xs rounded-full",children:e},e))})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("button",{onClick:()=>P(e),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:(0,t.jsx)(v.Z,{className:"h-4 w-4"})}),(0,t.jsx)("a",{href:e.url,download:!0,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:(0,t.jsx)(N,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>A(e.id),className:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors duration-200",children:(0,t.jsx)(w,{className:"h-4 w-4"})})]})]},e.id)})}),0===g.length&&!f&&(0,t.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(S.Z,{className:"h-8 w-8 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No images yet"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Start building your gallery by uploading some photos!"})]}),C&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl max-h-[90vh] overflow-hidden",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:C.url,alt:C.title||"Gallery image",className:"w-full h-auto max-h-[70vh] object-contain"}),(0,t.jsx)("button",{onClick:()=>P(null),className:"absolute top-4 right-4 p-2 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-75 transition-colors duration-200",children:"\xd7"})]}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:C.title||"Untitled"}),C.description&&(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:C.description}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-500",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Size:"})," ",z(null!==(d=null===(a=C.metadata)||void 0===a?void 0:a.size)&&void 0!==d?d:0)]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Format:"})," ",(null!==(m=null===(s=C.metadata)||void 0===s?void 0:s.format)&&void 0!==m?m:"").toUpperCase()]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Dimensions:"})," ",null!==(x=null===(l=C.metadata)||void 0===l?void 0:l.width)&&void 0!==x?x:0," \xd7 ",null!==(h=null===(n=C.metadata)||void 0===n?void 0:n.height)&&void 0!==h?h:0]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Uploaded:"})," ",I(C.createdAt)]})]}),(null!==(p=null===(o=C.tags)||void 0===o?void 0:o.length)&&void 0!==p?p:0)>0&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"Tags:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:(null!==(u=C.tags)&&void 0!==u?u:[]).map(e=>(0,t.jsx)("span",{className:"px-3 py-1 bg-primary-100 text-primary-700 text-sm rounded-full",children:e},e))})]})]})]})})]})}var P=s(9501),Z=s(9345);let E=(0,n.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),M=(0,n.Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var A=s(6337),z=s(7769);let I=(0,n.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);function U(e){let{user:a,onUpdate:s}=e,[l,n]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null),[h,p]=(0,r.useState)(a.avatar),[u,y]=(0,r.useState)("profile"),{register:g,handleSubmit:b,formState:{errors:f,isDirty:j},reset:N,watch:w}=(0,P.cI)({defaultValues:{name:a.name,username:a.username||"",bio:a.bio||"",location:a.location||"",website:a.website||"",currentPassword:"",newPassword:"",confirmPassword:""}}),k=w("newPassword"),C=async e=>{n(!0);try{let a=localStorage.getItem("token"),t=new FormData;m&&t.append("avatar",m),t.append("name",e.name),t.append("username",e.username),t.append("bio",e.bio),t.append("location",e.location),t.append("website",e.website),e.newPassword&&(t.append("currentPassword",e.currentPassword),t.append("newPassword",e.newPassword));let r=await fetch("/api/users/profile",{method:"PUT",headers:{Authorization:"Bearer ".concat(a)},body:t});if(r.ok){let a=await r.json();s(a.data.user),N({...e,currentPassword:"",newPassword:"",confirmPassword:""}),x(null)}else{let e=await r.json();alert(e.message||"Failed to update profile")}}catch(e){console.error("Failed to update profile:",e),alert("Failed to update profile")}finally{n(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-serif font-bold text-gray-900",children:"Profile Settings"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your profile information and preferences"})]}),(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsxs)("nav",{className:"flex space-x-8",children:[(0,t.jsx)("button",{onClick:()=>y("profile"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("profile"===u?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Profile Information"}),(0,t.jsx)("button",{onClick:()=>y("security"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("security"===u?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Security"})]})}),(0,t.jsxs)("form",{onSubmit:b(C),className:"space-y-8",children:["profile"===u&&(0,t.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Profile Picture"}),(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-primary-400 to-accent-500 rounded-full flex items-center justify-center text-white text-2xl font-semibold overflow-hidden",children:h?(0,t.jsx)("img",{src:h,alt:"Profile avatar",className:"w-full h-full object-cover"}):a.name.charAt(0).toUpperCase()}),(0,t.jsxs)("label",{className:"absolute bottom-0 right-0 bg-white rounded-full p-2 shadow-lg cursor-pointer hover:bg-gray-50 transition-colors duration-200",children:[(0,t.jsx)(S.Z,{className:"h-4 w-4 text-gray-600"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var a;let s=null===(a=e.target.files)||void 0===a?void 0:a[0];if(s){x(s);let e=new FileReader;e.onload=e=>{var a;p(null===(a=e.target)||void 0===a?void 0:a.result)},e.readAsDataURL(s)}},className:"hidden"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:"Upload a new photo"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"JPG, PNG or GIF. Max size 5MB."})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(c.Z,{className:"h-4 w-4 inline mr-2"}),"Full Name"]}),(0,t.jsx)("input",{type:"text",...g("name",{required:"Name is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter your full name"}),f.name&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.name.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(c.Z,{className:"h-4 w-4 inline mr-2"}),"Username"]}),(0,t.jsx)("input",{type:"text",...g("username",{pattern:{value:/^[a-zA-Z0-9_]+$/,message:"Username can only contain letters, numbers, and underscores"}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter username"}),f.username&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.username.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(Z.Z,{className:"h-4 w-4 inline mr-2"}),"Email Address"]}),(0,t.jsx)("input",{type:"email",value:a.email,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Email cannot be changed"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(E,{className:"h-4 w-4 inline mr-2"}),"Location"]}),(0,t.jsx)("input",{type:"text",...g("location"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter your location"})]})]}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(M,{className:"h-4 w-4 inline mr-2"}),"Website"]}),(0,t.jsx)("input",{type:"url",...g("website"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"https://your-website.com"})]}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),(0,t.jsx)("textarea",{...g("bio"),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",placeholder:"Tell us about yourself..."})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Privacy Settings"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:"Private Profile"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Only approved followers can see your posts and profile"})]}),(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",defaultChecked:a.isPrivate,className:"sr-only peer"}),(0,t.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"})]})]})]})]}),"security"===u&&(0,t.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(A.Z,{className:"h-4 w-4 inline mr-2"}),"Current Password"]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:o?"text":"password",...g("currentPassword"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent pr-10",placeholder:"Enter current password"}),(0,t.jsx)("button",{type:"button",onClick:()=>d(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o?(0,t.jsx)(z.Z,{className:"h-4 w-4 text-gray-400"}):(0,t.jsx)(v.Z,{className:"h-4 w-4 text-gray-400"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(A.Z,{className:"h-4 w-4 inline mr-2"}),"New Password"]}),(0,t.jsx)("input",{type:"password",...g("newPassword",{minLength:{value:8,message:"Password must be at least 8 characters"}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter new password"}),f.newPassword&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.newPassword.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(A.Z,{className:"h-4 w-4 inline mr-2"}),"Confirm New Password"]}),(0,t.jsx)("input",{type:"password",...g("confirmPassword",{validate:e=>e===k||"Passwords do not match"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Confirm new password"}),f.confirmPassword&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.confirmPassword.message})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Security"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:"Two-Factor Authentication"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Add an extra layer of security to your account"})]}),(0,t.jsx)("button",{type:"button",className:"btn-secondary",children:"Enable"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:"Login Sessions"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Manage your active login sessions"})]}),(0,t.jsx)("button",{type:"button",className:"btn-secondary",children:"View Sessions"})]})]})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsxs)("button",{type:"submit",disabled:l||!j,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[(0,t.jsx)(I,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:l?"Saving...":"Save Changes"})]})})]})]})}var F=s(5095),D=s(2489);let T=(0,n.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),B=(0,n.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),L=(0,n.Z)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);function G(e){let{userId:a,onClose:s,onUploadComplete:l}=e,[n,o]=(0,r.useState)([]),[c,d]=(0,r.useState)(!1),[m,x]=(0,r.useState)(!1),h=(0,r.useRef)(null),p=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?x(!0):"dragleave"===e.type&&x(!1)},u=e=>{y(Array.from(e.target.files||[]))},y=e=>{e.filter(e=>e.type.startsWith("image/")).forEach(e=>{let a=new FileReader;a.onload=a=>{var s;let t={file:e,preview:null===(s=a.target)||void 0===s?void 0:s.result,title:e.name.replace(/\.[^/.]+$/,""),description:"",tags:[]};o(e=>[...e,t])},a.readAsDataURL(e)})},g=e=>{o(a=>a.filter((a,s)=>s!==e))},b=(e,a)=>{o(s=>s.map((s,t)=>t===e?{...s,...a}:s))},f=(e,a)=>{a.trim()&&!n[e].tags.includes(a.trim())&&b(e,{tags:[...n[e].tags,a.trim()]})},j=(e,a)=>{b(e,{tags:n[e].tags.filter(e=>e!==a)})},v=async()=>{if(0!==n.length){d(!0);try{let e=localStorage.getItem("token");for(let s of n){let t=new FormData;if(t.append("image",s.file),t.append("title",s.title),t.append("description",s.description),t.append("tags",JSON.stringify(s.tags)),t.append("userId",a),!(await fetch("/api/images/upload",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:t})).ok)throw Error("Failed to upload ".concat(s.file.name))}l()}catch(e){console.error("Upload failed:",e),alert("Failed to upload images. Please try again.")}finally{d(!1)}}};return(0,t.jsx)(F.M,{children:(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)(i.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Upload Images"}),(0,t.jsx)("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full transition-colors duration-200",children:(0,t.jsx)(D.Z,{className:"h-5 w-5 text-gray-500"})})]}),(0,t.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[0===n.length&&(0,t.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors duration-200 ".concat(m?"border-primary-500 bg-primary-50":"border-gray-300 hover:border-gray-400"),onDragEnter:p,onDragLeave:p,onDragOver:p,onDrop:e=>{e.preventDefault(),e.stopPropagation(),x(!1),y(Array.from(e.dataTransfer.files))},children:[(0,t.jsx)(T,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drop images here or click to browse"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Upload JPG, PNG, or GIF files up to 10MB each"}),(0,t.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},className:"btn-primary",children:"Choose Files"}),(0,t.jsx)("input",{ref:h,type:"file",multiple:!0,accept:"image/*",onChange:u,className:"hidden"})]}),n.length>0&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:[n.length," ",1===n.length?"image":"images"," selected"]}),(0,t.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},className:"btn-secondary",children:"Add More"})]}),(0,t.jsx)("div",{className:"space-y-4",children:n.map((e,a)=>(0,t.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-50 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("img",{src:e.preview,alt:e.title,className:"w-20 h-20 object-cover rounded-lg"})}),(0,t.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,t.jsx)(B,{className:"h-4 w-4 inline mr-1"}),"Title"]}),(0,t.jsx)("input",{type:"text",value:e.title,onChange:e=>b(a,{title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter image title"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,t.jsx)("textarea",{value:e.description,onChange:e=>b(a,{description:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",placeholder:"Enter image description (optional)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,t.jsx)(L,{className:"h-4 w-4 inline mr-1"}),"Tags"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:e.tags.map((e,s)=>(0,t.jsxs)("span",{className:"px-2 py-1 bg-primary-100 text-primary-700 text-sm rounded-full flex items-center space-x-1",children:[(0,t.jsx)("span",{children:e}),(0,t.jsx)("button",{type:"button",onClick:()=>j(a,e),className:"hover:text-primary-900",children:"\xd7"})]},s))}),(0,t.jsx)("input",{type:"text",placeholder:"Add a tag and press Enter",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),f(a,e.currentTarget.value),e.currentTarget.value="")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>g(a),className:"flex-shrink-0 p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors duration-200",children:(0,t.jsx)(D.Z,{className:"h-5 w-5"})})]})},a))}),(0,t.jsx)("input",{ref:h,type:"file",multiple:!0,accept:"image/*",onChange:u,className:"hidden"})]})]}),n.length>0&&(0,t.jsxs)("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[(0,t.jsx)("button",{type:"button",onClick:s,className:"btn-secondary",disabled:c,children:"Cancel"}),(0,t.jsxs)("button",{type:"button",onClick:v,disabled:c,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[(0,t.jsx)(T,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:c?"Uploading...":"Upload ".concat(n.length," ").concat(1===n.length?"Image":"Images")})]})]})]})})})}function O(){let e=(0,l.useRouter)(),[a,s]=(0,r.useState)(null),[n,p]=(0,r.useState)("feed"),[u,y]=(0,r.useState)(!0),[g,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{f()},[]);let f=async()=>{try{let a=localStorage.getItem("token");if(!a){e.push("/");return}let t=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(a)}});if(t.ok){let e=await t.json();s(e.data.user)}else localStorage.removeItem("token"),e.push("/")}catch(a){console.error("Auth check failed:",a),e.push("/")}finally{y(!1)}};return u?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-white via-blue-50 to-indigo-100 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})}):a?(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-white via-blue-50 to-indigo-100",children:[(0,t.jsx)("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-50",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-400 to-accent-500 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white font-bold text-sm",children:"R"})}),(0,t.jsx)("span",{className:"text-xl font-serif font-bold gradient-text",children:"Reedi"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("button",{onClick:()=>b(!0),className:"btn-primary flex items-center space-x-2",children:[(0,t.jsx)(o,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Upload Image"})]}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsxs)("button",{className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-400 to-accent-500 rounded-full flex items-center justify-center text-white font-semibold",children:a.avatar?(0,t.jsx)("img",{src:a.avatar,alt:a.name,className:"w-8 h-8 rounded-full object-cover"}):a.name.charAt(0).toUpperCase()}),(0,t.jsx)("span",{className:"hidden md:block font-medium",children:a.name})]}),(0,t.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200",children:(0,t.jsxs)("div",{className:"py-1",children:[(0,t.jsxs)("button",{onClick:()=>p("profile"),className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center space-x-2",children:[(0,t.jsx)(c.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Profile"})]}),(0,t.jsxs)("button",{onClick:()=>{localStorage.removeItem("token"),e.push("/")},className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center space-x-2 text-red-600",children:[(0,t.jsx)(d,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Logout"})]})]})})]})]})]})})}),(0,t.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-3xl font-serif font-bold text-gray-900 mb-2",children:["Welcome back, ",a.name,"! \uD83D\uDC4B"]}),(0,t.jsx)("p",{className:"text-gray-600",children:"Here's what's happening with your family and friends"})]}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("nav",{className:"flex space-x-1 bg-white rounded-lg p-1 shadow-sm border border-gray-200",children:[(0,t.jsxs)("button",{onClick:()=>p("feed"),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-colors duration-200 ".concat("feed"===n?"bg-primary-100 text-primary-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[(0,t.jsx)(m,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Feed"})]}),(0,t.jsxs)("button",{onClick:()=>p("gallery"),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-colors duration-200 ".concat("gallery"===n?"bg-primary-100 text-primary-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[(0,t.jsx)(x,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Gallery"})]}),(0,t.jsxs)("button",{onClick:()=>p("profile"),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-colors duration-200 ".concat("profile"===n?"bg-primary-100 text-primary-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[(0,t.jsx)(h,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Profile"})]})]})}),(0,t.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},children:["feed"===n&&(0,t.jsx)(j,{userId:a.id}),"gallery"===n&&(0,t.jsx)(C,{userId:a.id}),"profile"===n&&(0,t.jsx)(U,{user:a,onUpdate:e=>{s(e)}})]},n)]}),g&&(0,t.jsx)(G,{userId:a.id,onClose:()=>b(!1),onUploadComplete:()=>{b(!1)}})]}):null}}},function(e){e.O(0,[532,971,117,744],function(){return e(e.s=8890)}),_N_E=e.O()}]);